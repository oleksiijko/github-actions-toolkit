name: Full GitHub Actions Toolkit Test

on:
  workflow_dispatch:
  push:
  pull_request:

jobs:
  summarize-pr:
    name: ğŸ¤– AI PR Summarizer
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Run AI PR Summarizer
        uses: ./ai-pr-summarizer
        with:
          pr_number: ${{ github.event.pull_request.number }}
          openai_api_key: ${{ secrets.OPENAI_API_KEY }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Print GPT Summary
        run: cat summary.md || echo "No summary generated"

      - name: Upload PR Summary
        uses: actions/upload-artifact@v4
        with:
          name: pr-summary
          path: summary.md

  chatops-command:
    name: ğŸ’¬ ChatOps Command Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./chatops-pr-bot
        with:
          payload_path: ./examples/payload.json

  code-formatter:
    name: ğŸ§¹ Code Formatter
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: cp -r ./examples/nodejs-project/* ./
      - uses: ./code-formatter
        with:
          example_input: prettier
      - name: Show formatted files
        run: git diff --stat || echo "No changes"

  update-deps:
    name: ğŸ“¦ Auto Update Dependencies
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: cp -r ./examples/nodejs-project/* ./
      - uses: ./auto-update-dependencies
        with:
          package_manager: npm
          commit_message: "test: deps"
          branch: main

  secrets-scan:
    name: ğŸ” Secrets Scanner
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./secrets-scanner

  security-scan:
    name: ğŸ”’ Security Scanner
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./security-scanner

  performance-report:
    name: ğŸ“Š Performance Report
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./performance-report-generator

  badge-gen:
    name: ğŸ… Badge Generator
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./badge-generator

  dependency-diff:
    name: ğŸ“¦ Dependency Diff
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./dependency-diff

  dead-code:
    name: ğŸ§¹ Dead Code Cleaner
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./dead-code-cleaner

  artifact-upload:
    name: ğŸ’¾ Artifact Uploader
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./artifact-uploader

  deploy-anywhere:
    name: ğŸŒ Deploy Anywhere
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./deploy-anywhere

  monorepo-splitter:
    name: ğŸ“„ Monorepo Splitter
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./monorepo-splitter

  setup-toolkit:
    name: âš–ï¸ Setup Toolkit
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./setup-toolkit

  pr-automator:
    name: ğŸ”„ PR Automator
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./pr-automator

  test-matrix:
    name: ğŸ“Š Matrix Runner
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node: [14, 16, 18]
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node }}
      - uses: ./test-matrix-runner

  test-runner:
    name: âœ… Test Runner
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: ./test-runner
